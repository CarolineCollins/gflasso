---
title: "Experimenting with simulated data"
author: "Vignette Author"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Vignette Title}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, echo = F}
library("knitr")
library("gflasso")
library("ggplot2")
library("grid")
opts_chunk$set(fig.width = 8, fig.height = 8, fig.align = "center")

scale_colour_discrete <- function(...)
  scale_colour_brewer(..., palette="Set2")
small_theme <- function(base_size = 7, base_family = "Helvetica") {
  theme_bw(base_size = base_size, base_family = base_family) %+replace%
  theme(axis.title = element_text(size = rel(0.8)),
        legend.title = element_text(size = rel(0.8)),
        legend.text = element_text(size = rel(0.8)),
        plot.title = element_text(size = rel(1.1)),
        plot.margin = unit(c(0.1, .1, .1, .1), "lines")
        )
}
theme_set(small_theme())
read_chunk("simulated_data.R")
```

Here is a toy example applying the GF-lasso. The data is drawn from an
actual sparse regression model.

```{r, simulate-data}
```

This fits a GF-lasso, tying all the responses together (even though in
the simulation, they are not actually related). There are a few
parameters involved, but I haven't systematically tuned them.

```{r, gflasso}
```

The objective decreases pretty quickly, and stabilizes.

```{r, vis-objective}
```

Our estimated $\beta$ is not too far off. Note it shrinks things a
little.

```{r, coef-hat-pred}
```

But we haven't really recovered the zero pattern.

```{r, vis-coefs}
```
